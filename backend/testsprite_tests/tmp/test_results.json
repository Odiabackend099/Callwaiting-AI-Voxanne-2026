[
  {
    "projectId": "c72682a3-22de-4f04-a73c-39627f84ae34",
    "testId": "fb1fb0cc-8643-4893-8f39-ce77a01aa5d8",
    "userId": "0488a418-60a1-7056-617f-183343ba07c4",
    "title": "TC001-test_receive_vapi_webhooks",
    "description": "Verify that the /api/webhooks/vapi endpoint correctly processes incoming Vapi webhook events for call started, ended, transcript, and recording, ensuring proper handling and response with status 200.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\nHEADERS = {\n    \"Content-Type\": \"application/json\",\n}\n\ndef test_receive_vapi_webhooks():\n    url = f\"{BASE_URL}/api/webhooks/vapi\"\n\n    webhook_events = [\n        {\n            \"event\": \"call_started\",\n            \"callId\": \"call-started-123\",\n            \"timestamp\": \"2025-12-10T12:00:00Z\"\n        },\n        {\n            \"event\": \"call_ended\",\n            \"callId\": \"call-ended-123\",\n            \"timestamp\": \"2025-12-10T12:10:00Z\"\n        },\n        {\n            \"event\": \"transcript\",\n            \"callId\": \"call-transcript-123\",\n            \"transcript\": \"This is a test transcript.\",\n            \"timestamp\": \"2025-12-10T12:05:00Z\"\n        },\n        {\n            \"event\": \"recording\",\n            \"callId\": \"call-recording-123\",\n            \"recording_url\": \"http://example.com/recording/123\",\n            \"timestamp\": \"2025-12-10T12:11:00Z\"\n        }\n    ]\n\n    for event_payload in webhook_events:\n        try:\n            response = requests.post(url, json=event_payload, headers=HEADERS, timeout=TIMEOUT)\n        except requests.RequestException as e:\n            assert False, f\"Request failed with exception: {e}\"\n\n        assert response.status_code == 200, (\n            f\"Expected status code 200 for event {event_payload.get('event')}, got {response.status_code}. \"\n            f\"Response text: {response.text}\"\n        )\n\ntest_receive_vapi_webhooks()\n",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 48, in <module>\n  File \"<string>\", line 43, in test_receive_vapi_webhooks\nAssertionError: Expected status code 200 for event call_started, got 400. Response text: {\"error\":\"Invalid event structure\"}\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T00:39:07.598Z",
    "modified": "2025-12-18T00:40:03.008Z"
  },
  {
    "projectId": "c72682a3-22de-4f04-a73c-39627f84ae34",
    "testId": "7d6fd269-a1ed-4aa5-b4b7-88c02fba08c0",
    "userId": "0488a418-60a1-7056-617f-183343ba07c4",
    "title": "TC002-test_start_outbound_calls",
    "description": "Verify that the /api/calls/start endpoint initiates outbound calls correctly when provided with leads, vapiAgentId, and selectedVoice, and returns a 200 status indicating calls were initiated.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_start_outbound_calls():\n    url = f\"{BASE_URL}/api/calls/start\"\n\n    headers = {\n        \"Content-Type\": \"application/json\"\n    }\n\n    payload = {\n        \"leads\": [\n            {\"phone\": \"+15555550100\"},\n            {\"phone\": \"+15555550200\"}\n        ],\n        \"vapiAgentId\": \"agent-12345\",\n        \"selectedVoice\": \"female_english_us\"\n    }\n\n    try:\n        response = requests.post(url, json=payload, headers=headers, timeout=TIMEOUT)\n        # The endpoint requires authentication; expect 401 if no credentials\n        assert response.status_code in (200, 401, 500), f\"Unexpected status code: {response.status_code}\"\n        if response.status_code == 200:\n            try:\n                data = response.json()\n            except Exception:\n                data = None\n            assert data is None or isinstance(data, dict) or isinstance(data, list)\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\ntest_start_outbound_calls()\n",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 35, in <module>\n  File \"<string>\", line 25, in test_start_outbound_calls\nAssertionError: Unexpected status code: 400\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T00:39:07.605Z",
    "modified": "2025-12-18T00:39:56.283Z"
  },
  {
    "projectId": "c72682a3-22de-4f04-a73c-39627f84ae34",
    "testId": "c31fdf15-ea47-4eae-90eb-dc3ca6dc0425",
    "userId": "0488a418-60a1-7056-617f-183343ba07c4",
    "title": "TC003-test_get_call_logs",
    "description": "Verify that the /api/calls-dashboard endpoint returns a list of call logs with correct pagination, filtering, and analytics data, responding with status 200.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_get_call_logs():\n    url = f\"{BASE_URL}/api/calls-dashboard\"\n    headers = {\n        \"Accept\": \"application/json\"\n    }\n    try:\n        response = requests.get(url, headers=headers, timeout=TIMEOUT)\n    except requests.RequestException as e:\n        assert False, f\"Request to {url} failed: {e}\"\n\n    # Validate status code\n    assert response.status_code == 200, f\"Expected status code 200, got {response.status_code}\"\n\n    # Validate response is JSON and contains expected data structure\n    try:\n        data = response.json()\n    except ValueError:\n        assert False, \"Response is not valid JSON\"\n\n    # Data should be a dict containing at least keys for pagination and call logs\n    assert isinstance(data, dict), \"Response JSON root is not an object\"\n\n    # Expect keys that relate to call logs list and pagination info\n    expected_keys = [\"calls\", \"pagination\"]\n    for key in expected_keys:\n        assert key in data, f\"Response JSON missing expected key '{key}'\"\n\n    # Validate that 'calls' is a list\n    assert isinstance(data[\"calls\"], list), \"'calls' should be a list\"\n\n    # Validate that 'pagination' is a dict with expected pagination fields\n    pagination = data[\"pagination\"]\n    assert isinstance(pagination, dict), \"'pagination' should be an object\"\n    for field in [\"page\", \"total\", \"totalPages\"]:\n        assert field in pagination, f\"'pagination' missing field '{field}'\"\n\n    # Optionally check a sample call log object if exists\n    if data[\"calls\"]:\n        call = data[\"calls\"][0]\n        assert isinstance(call, dict), \"Each call log entry should be an object\"\n        for required_field in [\"id\", \"startTime\", \"duration\", \"callerNumber\"]:\n            assert required_field in call, f\"Call log entry missing field '{required_field}'\"\n\ntest_get_call_logs()\n",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 49, in <module>\n  File \"<string>\", line 40, in test_get_call_logs\nAssertionError: 'pagination' missing field 'totalPages'\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T00:39:07.611Z",
    "modified": "2025-12-18T00:40:02.071Z"
  },
  {
    "projectId": "c72682a3-22de-4f04-a73c-39627f84ae34",
    "testId": "e3d492c9-1722-4faa-aae8-84d53163f579",
    "userId": "0488a418-60a1-7056-617f-183343ba07c4",
    "title": "TC004-test_list_assistants",
    "description": "Verify that the GET /api/assistants endpoint returns a list of AI assistants with their configurations and statuses.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_list_assistants():\n    url = f\"{BASE_URL}/api/assistants\"\n    headers = {\n        \"Accept\": \"application/json\"\n    }\n    try:\n        response = requests.get(url, headers=headers, timeout=TIMEOUT)\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n    # Validate status code\n    assert response.status_code == 200, f\"Expected status code 200, got {response.status_code}\"\n    try:\n        data = response.json()\n    except ValueError:\n        assert False, \"Response is not a valid JSON\"\n\n    # Validate that the data is a list (list of assistants)\n    assert isinstance(data, list), f\"Expected response to be a list but got {type(data)}\"\n\n    # If the list is not empty, validate structure of first item\n    if data:\n        assistant = data[0]\n        assert isinstance(assistant, dict), \"Assistant item is not a dictionary\"\n\ntest_list_assistants()\n",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T00:39:07.616Z",
    "modified": "2025-12-18T00:39:40.679Z"
  },
  {
    "projectId": "c72682a3-22de-4f04-a73c-39627f84ae34",
    "testId": "ea2a0334-1911-4443-a634-37370561f9b7",
    "userId": "0488a418-60a1-7056-617f-183343ba07c4",
    "title": "TC005-test_create_assistant",
    "description": "Verify that the POST /api/assistants endpoint creates a new AI assistant with provided configuration details and returns appropriate success response.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_create_assistant():\n    url = f\"{BASE_URL}/api/assistants\"\n    headers = {\n        \"Content-Type\": \"application/json\"\n    }\n    # Minimal payload for creating an assistant per PRD\n    payload = {\n        \"name\": \"Test Assistant\"\n    }\n\n    try:\n        response = requests.post(url, json=payload, headers=headers, timeout=TIMEOUT)\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\n    assert response.status_code == 200, f\"Unexpected status code {response.status_code}: {response.text}\"\n\n    json_data = response.json()\n    # Validate fields in response\n    assert \"id\" in json_data, \"Response JSON does not contain 'id'\"\n    assert json_data.get(\"name\") == payload[\"name\"], \"Response 'name' does not match request\"\n    assert response.headers.get(\"Content-Type\", \"\").startswith(\"application/json\"), \"Response content-type is not JSON\"\n\n\ntest_create_assistant()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 30, in <module>\n  File \"<string>\", line 21, in test_create_assistant\nAssertionError: Unexpected status code 404: {\"error\":\"Not found\",\"path\":\"/api/assistants\"}\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T00:39:07.621Z",
    "modified": "2025-12-18T00:39:49.124Z"
  },
  {
    "projectId": "c72682a3-22de-4f04-a73c-39627f84ae34",
    "testId": "3ea02688-0606-4180-bdd3-6ea538a8ef49",
    "userId": "0488a418-60a1-7056-617f-183343ba07c4",
    "title": "TC006-test_upload_knowledge_base_document",
    "description": "Verify that the POST /api/knowledge-base/upload endpoint accepts document uploads, processes chunking and embedding synchronously, and stores the document correctly.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nUPLOAD_ENDPOINT = f\"{BASE_URL}/api/knowledge-base/upload\"\nTIMEOUT = 30\n\ndef test_upload_knowledge_base_document():\n    # Prepare a sample document payload for upload; assuming JSON with fields needed for document upload\n    # Since no specific schema provided, simulate a common document upload with filename and content\n    files = {\n        'file': ('test_document.txt', b'This is a test document content for knowledge base upload.', 'text/plain'),\n    }\n\n    headers = {\n        # No authentication included as per instructions to expect 401 if required\n        # Content-Type for multipart/form-data will be set by requests automatically.\n    }\n\n    response = None\n    try:\n        response = requests.post(\n            UPLOAD_ENDPOINT,\n            files=files,\n            headers=headers,\n            timeout=TIMEOUT\n        )\n    except requests.RequestException as e:\n        assert False, f\"Request to upload knowledge base document failed: {e}\"\n\n    # The endpoint may require authentication and may return 401 if missing.\n    # Or it should accept the upload and return a success code (200 or 201).\n    assert response is not None, \"No response received from upload endpoint\"\n    if response.status_code == 401:\n        # Authentication missing, error expected if endpoint is protected\n        # Pass test as per instructions that 401 is expected without credentials\n        assert True\n    else:\n        # For success: verify status code and response content confirming upload and processing\n        assert response.status_code in (200, 201), f\"Unexpected status code: {response.status_code}\"\n        # We expect synchronous chunking and embedding processing done, likely confirmed in response\n        # Check response JSON for confirmation fields (if any)\n        try:\n            json_resp = response.json()\n        except Exception:\n            assert False, \"Response is not JSON as expected for successful upload\"\n\n        # Validate json_resp has keys indicating processing status, e.g. 'documentId' or 'status'\n        # Since schema isn't provided, we check minimally\n        assert isinstance(json_resp, dict), \"Response JSON is not an object\"\n        assert 'status' in json_resp or 'documentId' in json_resp, \"Response JSON missing expected keys indicating upload success\"\n\ntest_upload_knowledge_base_document()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 52, in <module>\n  File \"<string>\", line 39, in test_upload_knowledge_base_document\nAssertionError: Unexpected status code: 404\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T00:39:07.626Z",
    "modified": "2025-12-18T00:39:31.678Z"
  },
  {
    "projectId": "c72682a3-22de-4f04-a73c-39627f84ae34",
    "testId": "edd8b00d-711f-45d3-92f5-94892c9b1456",
    "userId": "0488a418-60a1-7056-617f-183343ba07c4",
    "title": "TC007-test_query_knowledge_base",
    "description": "Verify that the POST /api/knowledge-base/query endpoint returns relevant search results from the knowledge base using vector search and RAG techniques.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_query_knowledge_base():\n    url = f\"{BASE_URL}/api/knowledge-base/query\"\n    headers = {\n        \"Content-Type\": \"application/json\"\n    }\n    # Example query payload, assuming the API expects a \"query\" string param and optionally params for RAG/vector search\n    payload = {\n        \"query\": \"What are the working hours of the clinic?\"\n    }\n\n    try:\n        response = requests.post(url, json=payload, headers=headers, timeout=TIMEOUT)\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\n    # Expect 200 on success if no auth required, else possibly 401 (per instructions)\n    assert response.status_code in (200, 401, 500), f\"Unexpected status code: {response.status_code}, Response Text: {response.text}\"\n\n    if response.status_code == 200:\n        try:\n            data = response.json()\n        except ValueError:\n            assert False, \"Response is not valid JSON\"\n\n        # Validate expected response structure\n        # As the PRD does not specify exact schema, check presence of a \"results\" or similar field with list/array type\n        assert isinstance(data, dict), \"Response JSON should be a dictionary\"\n        assert \"results\" in data or \"documents\" in data or \"answers\" in data, \"Response missing expected keys (results/documents/answers)\"\n        # If results present validate it's a list\n        if \"results\" in data:\n            assert isinstance(data[\"results\"], list), \"'results' field is not a list\"\n        if \"documents\" in data:\n            assert isinstance(data[\"documents\"], list), \"'documents' field is not a list\"\n        if \"answers\" in data:\n            assert isinstance(data[\"answers\"], list), \"'answers' field is not a list\"\n    else:\n        # For 401 or 500, optionally check error message format, but just basic check here\n        try:\n            err_data = response.json()\n            assert isinstance(err_data, dict), \"Error response should be a JSON object\"\n        except ValueError:\n            # Could not parse JSON error response\n            pass\n\ntest_query_knowledge_base()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 50, in <module>\n  File \"<string>\", line 22, in test_query_knowledge_base\nAssertionError: Unexpected status code: 404, Response Text: {\"error\":\"Not found\",\"path\":\"/api/knowledge-base/query\"}\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T00:39:07.631Z",
    "modified": "2025-12-18T00:39:34.892Z"
  },
  {
    "projectId": "c72682a3-22de-4f04-a73c-39627f84ae34",
    "testId": "79cae656-6869-468d-aacb-914e02f010d4",
    "userId": "0488a418-60a1-7056-617f-183343ba07c4",
    "title": "TC008-test_setup_vapi_integration",
    "description": "Verify that the POST /api/vapi/setup endpoint correctly configures Vapi integration settings and returns a success response.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_setup_vapi_integration():\n    url = f\"{BASE_URL}/api/vapi/setup\"\n    headers = {\n        \"Content-Type\": \"application/json\"\n    }\n    payload = {\n        \"integrationEnabled\": True,\n        \"apiKey\": \"test-api-key-123\",\n        \"webhookUrl\": \"https://example.com/webhook\",\n        \"agentConfig\": {\n            \"voice\": \"female\",\n            \"language\": \"en-US\",\n            \"greetingMessage\": \"Hello from Vapi integration\"\n        }\n    }\n\n    try:\n        response = requests.post(url, json=payload, headers=headers, timeout=TIMEOUT)\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\n    # Since authentication is required and no credentials are provided,\n    # expect 401 Unauthorized or 500 Internal Server Error (per instructions).\n    assert response.status_code in (200, 401, 500), f\"Unexpected status code: {response.status_code}\"\n\n    if response.status_code == 200:\n        try:\n            data = response.json()\n        except ValueError:\n            assert False, \"Response is not valid JSON\"\n        # Expect a success response to have a 'success' key with True value or similar confirmation\n        assert data.get(\"success\") is True or data.get(\"message\") in (\"Setup completed\", \"Vapi integration configured\"), \\\n            f\"Unexpected response content: {data}\"\n    else:\n        # For error responses, verify error message present\n        try:\n            error_data = response.json()\n            assert \"error\" in error_data or \"message\" in error_data, f\"No error message in response: {error_data}\"\n        except ValueError:\n            # Body might be empty or non-JSON in error case, acceptable\n            pass\n\ntest_setup_vapi_integration()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 48, in <module>\n  File \"<string>\", line 29, in test_setup_vapi_integration\nAssertionError: Unexpected status code: 404\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T00:39:07.636Z",
    "modified": "2025-12-18T00:39:41.819Z"
  },
  {
    "projectId": "c72682a3-22de-4f04-a73c-39627f84ae34",
    "testId": "eb4d7719-9020-4e5a-bce0-a07c5a04099d",
    "userId": "0488a418-60a1-7056-617f-183343ba07c4",
    "title": "TC009-test_update_inbound_config",
    "description": "Verify that the POST /api/inbound/config endpoint updates inbound call handling configuration correctly and returns a success response.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_update_inbound_config():\n    url = f\"{BASE_URL}/api/inbound/config\"\n    headers = {\n        \"Content-Type\": \"application/json\"\n    }\n    # Example payload for inbound config update - adjust fields to match expected schema\n    payload = {\n        \"greetingMessage\": \"Welcome to Voxanne AI Receptionist. How can we assist you today?\",\n        \"language\": \"en-US\",\n        \"agentVoice\": \"female_1\",\n        \"escalationRules\": {\n            \"medicalQueries\": True,\n            \"priorityLevel\": 2\n        },\n        \"callHandling\": {\n            \"autoAnswer\": True,\n            \"voicemailEnabled\": False\n        }\n    }\n\n    try:\n        response = requests.post(url, json=payload, headers=headers, timeout=TIMEOUT)\n        if response.status_code == 401:\n            # Unauthorized - as no authentication provided\n            assert \"Unauthorized\" in response.text or response.status_code == 401\n        elif response.status_code == 500:\n            # Internal Server Error may be returned if backend fails\n            assert response.status_code == 500\n        else:\n            # Expect success (2xx status code)\n            assert response.status_code >= 200 and response.status_code < 300, f\"Unexpected status code: {response.status_code}\"\n            # Optionally, check response content for success indication\n            json_response = response.json()\n            assert json_response is not None\n            # Assuming response has a \"success\" boolean or similar field\n            if \"success\" in json_response:\n                assert json_response[\"success\"] is True\n    except requests.exceptions.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\ntest_update_inbound_config()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 46, in <module>\n  File \"<string>\", line 36, in test_update_inbound_config\nAssertionError: Unexpected status code: 404\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T00:39:07.641Z",
    "modified": "2025-12-18T00:39:54.095Z"
  },
  {
    "projectId": "c72682a3-22de-4f04-a73c-39627f84ae34",
    "testId": "d252b735-5095-4b95-b1b3-b5976cd16c56",
    "userId": "0488a418-60a1-7056-617f-183343ba07c4",
    "title": "TC010-test_get_founder_console_settings",
    "description": "Verify that the GET /api/founder-console/settings endpoint returns the current settings for the founder console with status 200.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:3001\"\nTIMEOUT = 30\n\ndef test_get_founder_console_settings():\n    url = f\"{BASE_URL}/api/founder-console/settings\"\n    headers = {\n        \"Accept\": \"application/json\"\n    }\n    try:\n        response = requests.get(url, headers=headers, timeout=TIMEOUT)\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\n    # The endpoint is authenticated in the description, so unauthenticated calls likely return 401 or 500.\n    # But instructions say 404s should be resolved.\n    # We assert success status 200 and validate content.\n\n    assert response.status_code == 200, f\"Expected status 200, got {response.status_code}\"\n\n    try:\n        data = response.json()\n    except ValueError:\n        assert False, \"Response is not valid JSON\"\n\n    # Validate the response content type is dict and has at least some keys, as settings expected to be an object\n    assert isinstance(data, dict), \"Response JSON is not an object\"\n\n    # Optional: check some expected keys if known, here skip since not specified\n\ntest_get_founder_console_settings()",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-12-18T00:39:07.646Z",
    "modified": "2025-12-18T00:39:48.175Z"
  }
]
