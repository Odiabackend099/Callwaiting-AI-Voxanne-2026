# ================================================================================
# VOXANNE BACKEND ENVIRONMENT VARIABLES - SINGLE SOURCE OF TRUTH
# ================================================================================
#
# CRITICAL RULES FOR THIS FILE:
# 1. This is the ONLY place backend configuration is defined
# 2. Never commit actual credential values to version control
# 3. All credentials must come from your deployment platform's secret management
# 4. All code must import `config` from src/config/index.ts (NOT process.env directly)
# 5. Tenant credentials (Twilio, Google, etc.) are OPTIONAL here and fetched from DB per clinic
#
# Last Updated: January 17, 2026
# ================================================================================

# ================================================================================
# REQUIRED: CORE APPLICATION SETTINGS
# ================================================================================
NODE_ENV=development
PORT=3001
LOG_LEVEL=info

# ================================================================================
# REQUIRED: SUPABASE (Database & Auth)
# ================================================================================
# Your Supabase project URL
SUPABASE_URL=https://your-supabase-project.supabase.co

# Supabase Service Role Key (KEEP SECURE - bypasses RLS)
# This is a SECRET that should NEVER be in frontend code or committed to git
# Generate at: https://app.supabase.com/project/YOUR_PROJECT/settings/api
SUPABASE_SERVICE_ROLE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...

# ================================================================================
# REQUIRED: VAPI (Voice AI Service)
# ================================================================================
# Vapi Private Key - Your master key for backend API calls to Vapi
# Get from: https://dashboard.vapi.ai/settings/api-keys
# ⚠️  KEEP SECURE - This is a server-side secret, NEVER expose to frontend or commit to git
VAPI_PRIVATE_KEY=YOUR_VAPI_PRIVATE_KEY_HERE

# Vapi Public Key - Safe to use in frontend/browser code
# Optional: Used for client-side Vapi SDK initialization if needed
# Get from: https://dashboard.vapi.ai/settings/api-keys
# VAPI_PUBLIC_KEY=YOUR_VAPI_PUBLIC_KEY_HERE

# Vapi Default Voice ID - Used when frontend sends empty voice selection
# Must be one of: Elliot, Kylie, Rohan, Lily, Savannah, Hana, Neha, Cole, Harry, Paige, Spencer, Leah, Tara, Jess, Leo, Dan, Mia, Zac, Zoe
# CRITICAL: Must be capitalized exactly as shown (Vapi 2026 API requirement)
# Default: Neha (warm, professional Indian accent - clinic-approved)
VAPI_DEFAULT_VOICE=Neha

# ================================================================================
# MULTI-TENANT ARCHITECTURE NOTE
# ================================================================================
# ⚠️ IMPORTANT: VAPI_ASSISTANT_ID is NOT stored here
# Each organization has its own Vapi Assistant ID stored in the database
# (organizations.vapi_assistant_id column)
# This enforces true BYOA (Bring Your Own Assistant) multi-tenancy

# ================================================================================
# REQUIRED: ENCRYPTION
# ================================================================================
# Master encryption key for encrypting tenant credentials in the database
# Generate with: openssl rand -hex 32 (MUST be exactly 64 hex characters)
# NEVER CHANGE THIS after data is encrypted (or all data becomes unreadable)
ENCRYPTION_KEY=0123456789abcdef0123456789abcdef0123456789abcdef0123456789abcdef

# ================================================================================
# OPTIONAL: OPENAI (For RAG search and knowledge base)
# ================================================================================
# OpenAI API key for embeddings and LLM calls
# Get from: https://platform.openai.com/api-keys
# OPENAI_API_KEY=sk-proj-your-key-here

# ================================================================================
# GOOGLE OAUTH - CALENDAR INTEGRATION
# ================================================================================
# CRITICAL: These MUST be set in production to avoid localhost redirect issues
#
# Platform-level Google OAuth credentials (used to configure clinic OAuth)
# Get from: https://console.cloud.google.com/apis/credentials
#
# GOOGLE_CLIENT_ID=your-google-client-id.apps.googleusercontent.com
# GOOGLE_CLIENT_SECRET=your-google-client-secret
#
# PRODUCTION REQUIREMENTS:
# ------------------------
# Option 1: Set explicit redirect URI (recommended)
#   GOOGLE_REDIRECT_URI=https://api.yourdomain.com/api/google-oauth/callback
#
# Option 2: Set BACKEND_URL (redirect URI auto-constructed)
#   BACKEND_URL=https://api.yourdomain.com
#
# IMPORTANT: Add this redirect URI to Google Cloud Console:
#   https://console.cloud.google.com/apis/credentials
#   → Select OAuth 2.0 Client ID
#   → Add to "Authorized redirect URIs"
#
# For local development only:
# GOOGLE_REDIRECT_URI=http://localhost:3001/api/google-oauth/callback

# ================================================================================
# OPTIONAL: TWILIO (For SMS - CLINIC-PROVIDED VIA DATABASE)
# ================================================================================
# ⚠️  IMPORTANT: Twilio credentials should NOT be stored here in production
# Each clinic provides their own Twilio SID, Auth Token, and phone number
# These are fetched from the database per clinic during SMS operations
#
# For development/testing only, you can set these to use a global Twilio account:
# TWILIO_ACCOUNT_SID=your-twilio-sid
# TWILIO_AUTH_TOKEN=your-twilio-token
# TWILIO_PHONE_NUMBER=+1234567890

# ================================================================================
# BACKEND URLS - PRODUCTION REQUIREMENTS
# ================================================================================
# CRITICAL: These MUST be set in production
#
# Where your backend is running (used for webhooks, OAuth redirects, etc.)
# Development:
BACKEND_URL=http://localhost:3001
FRONTEND_URL=http://localhost:3000
CORS_ORIGIN=http://localhost:3000
#
# Production example:
# BACKEND_URL=https://api.yourdomain.com
# FRONTEND_URL=https://app.yourdomain.com
# CORS_ORIGIN=https://app.yourdomain.com
#
# Vapi webhook URL (REQUIRED if using Vapi for phone calls)
# If not set, will be auto-constructed from BACKEND_URL
# WEBHOOK_URL=https://api.yourdomain.com/api/vapi/webhook
#
# IMPORTANT: Frontend URL is required for OAuth error redirects
# If not set in production, OAuth failures will return 500 errors

# ================================================================================
# OPTIONAL: EMAIL SERVICE
# ================================================================================
# Email provider configuration (choose one)
# RESEND_API_KEY=re_your_key_here
# FROM_EMAIL=noreply@yourdomain.com

# Or SMTP:
# SMTP_HOST=smtp.gmail.com
# SMTP_PORT=587
# SMTP_USER=your-email@gmail.com
# SMTP_PASSWORD=your-app-password

# ================================================================================
# OPTIONAL: ERROR TRACKING
# ================================================================================
# Sentry for production error monitoring
# SENTRY_DSN=https://your-key@sentry.io/your-project-id

# ================================================================================
# OPTIONAL: WEBSOCKET
# ================================================================================
# WebSocket configuration for real-time features
# WS_URL=ws://localhost:3001
WS_MAX_BUFFERED_BYTES=1000000

# ================================================================================
# OPTIONAL: RECORDING & MEDIA
# ================================================================================
# Call recording URL expiry in seconds (default: 1 hour)
# RECORDING_URL_EXPIRY_SECONDS=3600

# ================================================================================
# OPTIONAL: BUSINESS CONFIGURATION
# ================================================================================
# These can be overridden per clinic in the database (recommended)
# COMPANY_NAME=Your Company
# FOUNDER_NAME=Your Name
# CALENDAR_LINK=https://calendly.com/yourname
# DEMO_URL=https://demo.example.com
# TARGET_PERSONA=healthcare professionals

# ================================================================================
# DEVELOPMENT ONLY (NEVER in production)
# ================================================================================
# Auth bypass for local development (DANGEROUS - development only!)
# DEV_JWT_TOKEN=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
# DEV_USER_ID=dev-user-123
# DEV_USER_EMAIL=dev@localhost

# Debug flags (enable verbose logging in development)
# DEBUG_VAPI=false
# DEBUG_WEBSOCKET=false
# EXPOSE_DEBUG_INFO=false
# ALLOW_DEV_WS_BYPASS=false

# ================================================================================
# DEPLOYMENT (Auto-populated by deployment platform)
# ================================================================================
# Render.com will auto-set this:
# RENDER_EXTERNAL_URL=https://your-backend.onrender.com

# Custom webhook URL override:
# WEBHOOK_URL=https://your-backend.onrender.com/api/webhooks

# ================================================================================
# ARCHITECTURE NOTES
# ================================================================================
#
# YOUR ARCHITECTURE (Hybrid Credential Model):
#
# ┌─────────────────────────────────────────────────────────────┐
# │ PLATFORM SECRETS (You - in .env)                            │
# │ - VAPI_PRIVATE_KEY (voice AI - server-side only)            │
# │ - VAPI_PUBLIC_KEY (voice AI - safe for browser)             │
# │ - OPENAI_API_KEY (RAG search)                               │
# │ - SUPABASE_SERVICE_ROLE_KEY (database)                      │
# │ - ENCRYPTION_KEY (credential encryption)                    │
# └─────────────────────────────────────────────────────────────┘
#                              ↓
#              Your Backend (Single Provider)
#                              ↓
# ┌─────────────────────────────────────────────────────────────┐
# │ TENANT SECRETS (Clinics - in Database)                      │
# │ - TWILIO_ACCOUNT_SID, AUTH_TOKEN, PHONE (SMS)               │
# │ - GOOGLE_OAUTH_CREDENTIALS (Calendar)                       │
# └─────────────────────────────────────────────────────────────┘
#
# CODE RULE:
# ✓ Use: import { config } from './config'; config.VAPI_PRIVATE_KEY
# ✓ Use: import { config } from './config'; config.VAPI_PUBLIC_KEY (frontend-safe)
# ✗ Never: process.env.VAPI_API_KEY (old name - no longer used)
# ✗ Never: process.env.VAPI_PRIVATE_KEY directly (use centralized config)
# ✗ Never: const twilio = require('twilio')(env.SID, env.TOKEN)
#
# ================================================================================
