(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5105],{598:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>b});var s=r(5155),a=r(2115),l=r(4817),i=r(3321),n=r(2869);let o=(0,r(8340).A)("log-out",[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]]);var c=r(3210),u=r(9857),d=r(5118),h=r(3219),m=r(4980),x=r(9363),f=r(2985),p=r(8774),g=r(5772);function b(){let e=(0,i.useRouter)(),{signOut:t,user:r}=(0,f.A)(),[b,j]=(0,a.useState)(!0),[v,N]=(0,a.useState)({totalSessions:0,totalTranscripts:0}),[k,_]=(0,a.useState)(null),[I,A]=(0,a.useState)(!1);(0,a.useEffect)(()=>{S()},[]);let S=async()=>{try{let e=await (0,p.HW)();if(!e)return;try{let t=await (0,p.h_)(e.id);_(t)}catch(e){console.error(e)}try{let t=await (0,p.wx)(e.id);N(t)}catch(e){console.error(e)}}catch(e){console.error("Failed to load dashboard:",e)}finally{j(!1)}},C=async()=>{try{await t()}catch(e){console.error("Error signing out:",e)}};return b?(0,s.jsx)("div",{className:"min-h-screen bg-black text-white flex items-center justify-center",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-cyan-500"})}):(0,s.jsxs)("div",{className:"min-h-screen bg-black text-slate-200 font-sans selection:bg-cyan-500/30",children:[(0,s.jsxs)("header",{className:"sticky top-0 z-50 border-b border-white/10 bg-black/80 backdrop-blur-xl",children:[(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"relative w-8 h-8",children:(0,s.jsx)(g.default,{src:"/callwaiting-ai-logo.png",alt:"CallWaiting AI",fill:!0,className:"object-contain"})}),(0,s.jsx)("span",{className:"text-xl font-bold text-white tracking-tight",children:"CallWaiting AI"})]}),(0,s.jsxs)("nav",{className:"hidden md:flex items-center gap-6",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 px-3 py-1.5 rounded-full bg-white/5 border border-white/10",children:[(0,s.jsx)(n.A,{className:"w-4 h-4 text-slate-400"}),(0,s.jsx)("span",{className:"text-sm text-slate-300",children:r?.email})]}),(0,s.jsx)("button",{onClick:C,className:"p-2 text-slate-400 hover:text-white transition-colors hover:bg-white/5 rounded-lg",title:"Sign Out",children:(0,s.jsx)(o,{className:"w-5 h-5"})})]}),(0,s.jsx)("div",{className:"md:hidden",children:(0,s.jsx)("button",{onClick:()=>A(!I),className:"p-2 text-slate-400 hover:text-white",children:I?(0,s.jsx)(c.A,{className:"w-6 h-6"}):(0,s.jsx)(u.A,{className:"w-6 h-6"})})})]})}),I&&(0,s.jsx)("div",{className:"md:hidden border-t border-white/10 bg-black",children:(0,s.jsxs)("div",{className:"px-4 py-4 space-y-4",children:[(0,s.jsx)("div",{className:"text-sm text-slate-400 px-2",children:r?.email}),(0,s.jsxs)("button",{onClick:C,className:"flex items-center gap-2 text-red-400 hover:text-red-300 w-full px-2 py-2 hover:bg-white/5 rounded-lg transition-colors",children:[(0,s.jsx)(o,{className:"w-4 h-4"}),"Sign Out"]})]})})]}),(0,s.jsxs)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-6 mb-10",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-white mb-2",children:"Dashboard"}),(0,s.jsx)("p",{className:"text-slate-400",children:"Welcome back to your practice overview."})]}),(0,s.jsxs)(l.P.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>e.push("/dashboard/voice-test"),className:"flex items-center justify-center gap-2 bg-white text-black hover:bg-slate-200 px-6 py-3 rounded-full font-bold shadow-[0_0_20px_rgba(255,255,255,0.15)] transition-all w-full md:w-auto",children:[(0,s.jsx)(d.A,{className:"w-5 h-5 fill-black"}),"Test Voice Agent"]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-10",children:[(0,s.jsx)(w,{Icon:h.A,iconColor:"text-cyan-400",label:"Total Sessions",value:v.totalSessions}),(0,s.jsx)(w,{Icon:m.A,iconColor:"text-purple-400",label:"Total Messages",value:v.totalTranscripts}),(0,s.jsx)(w,{Icon:x.A,iconColor:"text-emerald-400",label:"Configuration",value:k?.business_name||"Not Configured",subValue:k?.business_name?"Active":"Setup Required"})]}),(0,s.jsx)("h2",{className:"text-xl font-bold text-white mb-6",children:"Management"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[(0,s.jsx)(y,{title:"Agent Settings",description:"Configure your business profile, operating hours, and voice personality.",icon:(0,s.jsx)(x.A,{className:"w-6 h-6 text-white"}),onClick:()=>e.push("/dashboard/settings")}),(0,s.jsx)(y,{title:"Call Logs",description:"Review transcripts and audio recordings of past calls.",icon:(0,s.jsx)(h.A,{className:"w-6 h-6 text-slate-400"}),disabled:!0,badge:"Coming Soon"})]})]})]})}function w({Icon:e,iconColor:t,label:r,value:a,subValue:i}){return(0,s.jsxs)(l.P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white/5 border border-white/10 rounded-2xl p-6 backdrop-blur-sm",children:[(0,s.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,s.jsx)("div",{className:"p-2 bg-white/5 rounded-lg border border-white/5",children:(0,s.jsx)(e,{className:`w-6 h-6 ${t}`})})}),(0,s.jsx)("div",{className:"text-3xl font-bold text-white mb-1 truncate",children:a}),(0,s.jsx)("div",{className:"text-sm font-medium text-slate-400",children:r}),i&&(0,s.jsx)("div",{className:"text-xs text-slate-500 mt-2",children:i})]})}function y({title:e,description:t,icon:r,onClick:a,disabled:i,badge:n}){return(0,s.jsxs)(l.P.button,{whileHover:i?{}:{scale:1.02,backgroundColor:"rgba(255,255,255,0.08)"},whileTap:i?{}:{scale:.98},onClick:a,disabled:i,className:`text-left w-full bg-white/5 border border-white/10 rounded-2xl p-6 transition-colors group relative overflow-hidden ${i?"opacity-60 cursor-not-allowed":"cursor-pointer"}`,children:[n&&(0,s.jsx)("div",{className:"absolute top-4 right-4 bg-white/10 text-xs px-2 py-1 rounded-full text-white/60 border border-white/5",children:n}),(0,s.jsx)("div",{className:`p-3 w-fit rounded-xl mb-4 ${i?"bg-slate-800":"bg-gradient-to-br from-cyan-500/20 to-blue-600/20 border border-cyan-500/30"}`,children:r}),(0,s.jsx)("h3",{className:"text-lg font-bold text-white mb-2 group-hover:text-cyan-400 transition-colors",children:e}),(0,s.jsx)("p",{className:"text-sm text-slate-400 leading-relaxed",children:t})]})}},1172:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useMergedRef",{enumerable:!0,get:function(){return a}});let s=r(2115);function a(e,t){let r=(0,s.useRef)(null),a=(0,s.useRef)(null);return(0,s.useCallback)(s=>{if(null===s){let e=r.current;e&&(r.current=null,e());let t=a.current;t&&(a.current=null,t())}else e&&(r.current=l(e,s)),t&&(a.current=l(t,s))},[e,t])}function l(e,t){if("function"!=typeof e)return e.current=t,()=>{e.current=null};{let r=e(t);return"function"==typeof r?r:()=>e(null)}}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},2869:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("user",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]])},2985:(e,t,r)=>{"use strict";r.d(t,{A:()=>c,AuthProvider:()=>o});var s=r(5155),a=r(2115),l=r(3318),i=r(3321);let n=(0,a.createContext)(void 0);function o({children:e}){let[t,r]=(0,a.useState)(null),[o,c]=(0,a.useState)(null),[u,d]=(0,a.useState)(null),[h,m]=(0,a.useState)(!0),[x,f]=(0,a.useState)(null),[p]=(0,a.useState)(()=>(0,l.createBrowserClient)("https://lbjymlodxprzqgtyqtcq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxianltbG9keHByenFndHlxdGNxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzNDk1MzEsImV4cCI6MjA3ODkyNTUzMX0.m9k-Id03Kt1scFWvIuK354EHjiO0Y-d8mbO53QqSMRU")),g=(0,i.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{let{data:e}=await p.auth.getSession();c(e.session),r(e.session?.user??null),e.session?.user&&await b(e.session.user.id)}catch(e){}finally{m(!1)}})();let{data:e}=p.auth.onAuthStateChange(async(e,t)=>{c(t),r(t?.user??null),t?.user?await b(t.user.id):d(null),"SIGNED_OUT"===e&&g.push("/login")});return()=>{e?.subscription.unsubscribe()}},[p,g]);let b=async e=>{try{let{data:t,error:r}=await p.from("user_settings").select().eq("user_id",e).single();r&&r.code,d(t||null)}catch(e){}},w=async(e,t,r)=>{try{f(null);let{data:s,error:a}=await p.auth.signUp({email:e,password:t,options:{emailRedirectTo:`${window.location.origin}/auth/callback`,data:r}});if(a)return f(a.message),{user:null,error:a};return{user:s.user,error:null}}catch(t){let e=t instanceof Error?t:Error("Sign up failed");return f(e.message),{user:null,error:e}}},y=async(e,t)=>{try{f(null);let{data:r,error:s}=await p.auth.signInWithPassword({email:e,password:t});if(s)return f(s.message),{user:null,error:s};return{user:r.user,error:null}}catch(t){let e=t instanceof Error?t:Error("Sign in failed");return f(e.message),{user:null,error:e}}},j=async()=>{try{f(null);let{error:e}=await p.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`,queryParams:{access_type:"offline",prompt:"consent"}}});if(e)return f(e.message),{error:e};return{error:null}}catch(t){let e=t instanceof Error?t:Error("Google sign in failed");return f(e.message),{error:e}}},v=async e=>{try{f(null);let{error:t}=await p.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/auth/callback?next=/update-password`});if(t)return f(t.message),{error:t};return{error:null}}catch(t){let e=t instanceof Error?t:Error("Reset password failed");return f(e.message),{error:e}}},N=async e=>{try{f(null);let{error:t}=await p.auth.updateUser({password:e});if(t)return f(t.message),{error:t};return{error:null}}catch(t){let e=t instanceof Error?t:Error("Update password failed");return f(e.message),{error:e}}},k=async()=>{try{f(null),await p.auth.signOut(),r(null),c(null),d(null)}catch(t){let e=t instanceof Error?t:Error("Sign out failed");throw f(e.message),e}},_=async e=>{try{if(!t)throw Error("User not authenticated");f(null);let{data:r,error:s}=await p.from("user_settings").upsert({user_id:t.id,...e,updated_at:new Date().toISOString()},{onConflict:"user_id"}).select().single();if(s)throw s;d(r)}catch(t){let e=t instanceof Error?t:Error("Update failed");throw f(e.message),e}},I=async()=>{try{if(!t)return;await b(t.id)}catch(e){console.error("Refresh user error:",e)}};return(0,s.jsx)(n.Provider,{value:{user:t,session:o,userSettings:u,loading:h,error:x,signUp:w,signIn:y,signInWithGoogle:j,resetPassword:v,updatePassword:N,signOut:k,updateUserSettings:_,refreshUser:I},children:e})}function c(){let e=(0,a.useContext)(n);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},3210:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},3219:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]])},4980:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},5118:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("phone",[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]])},5772:(e,t,r)=>{"use strict";r.d(t,{default:()=>a.a});var s=r(7651),a=r.n(s)},6385:(e,t,r)=>{"use strict";r.d(t,{N:()=>l});var s=r(3318);let a=null,l=a=(0,s.createBrowserClient)("https://lbjymlodxprzqgtyqtcq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxianltbG9keHByenFndHlxdGNxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzNDk1MzEsImV4cCI6MjA3ODkyNTUzMX0.m9k-Id03Kt1scFWvIuK354EHjiO0Y-d8mbO53QqSMRU")},6684:(e,t,r)=>{Promise.resolve().then(r.bind(r,598))},7651:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={default:function(){return u},getImageProps:function(){return c}};for(var a in s)Object.defineProperty(t,a,{enumerable:!0,get:s[a]});let l=r(3623),i=r(5413),n=r(8437),o=l._(r(6095));function c(e){let{props:t}=(0,i.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[32,48,64,96,128,256,384],qualities:[75],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,r]of Object.entries(t))void 0===r&&delete t[e];return{props:t}}let u=n.Image},8774:(e,t,r)=>{"use strict";r.d(t,{HW:()=>a,Jr:()=>c,gd:()=>n,h_:()=>l,pQ:()=>o,uT:()=>i,wx:()=>u});var s=r(6385);async function a(){let{data:{user:e},error:t}=await s.N.auth.getUser();if(t)throw t;return e}async function l(e){let{data:t,error:r}=await s.N.from("user_settings").select("*").eq("user_id",e).limit(1);if(r)throw console.error("Supabase error:",r),r;return t?.[0]||null}async function i(e,t){let{data:r,error:a}=await s.N.from("user_settings").upsert({user_id:e,...t,updated_at:new Date().toISOString()}).select().single();if(a)throw a;return r}async function n(e){let{data:t,error:r}=await s.N.from("knowledge_base").select("*").eq("user_id",e).order("created_at",{ascending:!1});if(r)throw r;return t||[]}async function o(e,t,r="knowledge.txt"){let{data:a,error:l}=await s.N.from("knowledge_base").insert({user_id:e,filename:r,content:t,file_type:"txt"}).select().single();if(l)throw l;return a}async function c(e){let{error:t}=await s.N.from("knowledge_base").delete().eq("id",e);if(t)throw t}async function u(e){let{count:t,error:r}=await s.N.from("voice_sessions").select("*",{count:"exact",head:!0}).eq("user_id",e);if(r)throw r;let{count:a,error:l}=await s.N.from("voice_test_transcripts").select("*",{count:"exact",head:!0}).eq("user_id",e);if(l)throw l;return{totalSessions:t||0,totalTranscripts:a||0}}},9363:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("settings",[["path",{d:"M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915",key:"1i5ecw"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},9857:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(8340).A)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]])}},e=>{e.O(0,[5946,8346,8437,8441,8928,7358],()=>e(e.s=6684)),_N_E=e.O()}]);