(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7177],{1743:()=>{},2985:(e,r,t)=>{"use strict";t.d(r,{A:()=>o,AuthProvider:()=>u});var s=t(5155),a=t(2115),n=t(3318),l=t(3321);let i=(0,a.createContext)(void 0);function u({children:e}){let[r,t]=(0,a.useState)(null),[u,o]=(0,a.useState)(null),[c,d]=(0,a.useState)(null),[h,f]=(0,a.useState)(!0),[y,m]=(0,a.useState)(null),[g]=(0,a.useState)(()=>(0,n.createBrowserClient)("https://lbjymlodxprzqgtyqtcq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxianltbG9keHByenFndHlxdGNxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzNDk1MzEsImV4cCI6MjA3ODkyNTUzMX0.m9k-Id03Kt1scFWvIuK354EHjiO0Y-d8mbO53QqSMRU")),w=(0,l.useRouter)();(0,a.useEffect)(()=>{(async()=>{try{let{data:e}=await g.auth.getSession();o(e.session),t(e.session?.user??null),e.session?.user&&await p(e.session.user.id)}catch(e){}finally{f(!1)}})();let{data:e}=g.auth.onAuthStateChange(async(e,r)=>{o(r),t(r?.user??null),r?.user?await p(r.user.id):d(null),"SIGNED_OUT"===e&&w.push("/login")});return()=>{e?.subscription.unsubscribe()}},[g,w]);let p=async e=>{try{let{data:r,error:t}=await g.from("user_settings").select().eq("user_id",e).single();t&&t.code,d(r||null)}catch(e){}},b=async(e,r,t)=>{try{m(null);let{data:s,error:a}=await g.auth.signUp({email:e,password:r,options:{emailRedirectTo:`${window.location.origin}/auth/callback`,data:t}});if(a)return m(a.message),{user:null,error:a};return{user:s.user,error:null}}catch(r){let e=r instanceof Error?r:Error("Sign up failed");return m(e.message),{user:null,error:e}}},_=async(e,r)=>{try{m(null);let{data:t,error:s}=await g.auth.signInWithPassword({email:e,password:r});if(s)return m(s.message),{user:null,error:s};return{user:t.user,error:null}}catch(r){let e=r instanceof Error?r:Error("Sign in failed");return m(e.message),{user:null,error:e}}},E=async()=>{try{m(null);let{error:e}=await g.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`,queryParams:{access_type:"offline",prompt:"consent"}}});if(e)return m(e.message),{error:e};return{error:null}}catch(r){let e=r instanceof Error?r:Error("Google sign in failed");return m(e.message),{error:e}}},I=async e=>{try{m(null);let{error:r}=await g.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/auth/callback?next=/update-password`});if(r)return m(r.message),{error:r};return{error:null}}catch(r){let e=r instanceof Error?r:Error("Reset password failed");return m(e.message),{error:e}}},S=async e=>{try{m(null);let{error:r}=await g.auth.updateUser({password:e});if(r)return m(r.message),{error:r};return{error:null}}catch(r){let e=r instanceof Error?r:Error("Update password failed");return m(e.message),{error:e}}},v=async()=>{try{m(null),await g.auth.signOut(),t(null),o(null),d(null)}catch(r){let e=r instanceof Error?r:Error("Sign out failed");throw m(e.message),e}},k=async e=>{try{if(!r)throw Error("User not authenticated");m(null);let{data:t,error:s}=await g.from("user_settings").upsert({user_id:r.id,...e,updated_at:new Date().toISOString()},{onConflict:"user_id"}).select().single();if(s)throw s;d(t)}catch(r){let e=r instanceof Error?r:Error("Update failed");throw m(e.message),e}},N=async()=>{try{if(!r)return;await p(r.id)}catch(e){console.error("Refresh user error:",e)}};return(0,s.jsx)(i.Provider,{value:{user:r,session:u,userSettings:c,loading:h,error:y,signUp:b,signIn:_,signInWithGoogle:E,resetPassword:I,updatePassword:S,signOut:v,updateUserSettings:k,refreshUser:N},children:e})}function o(){let e=(0,a.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},3104:e=>{e.exports={style:{fontFamily:"'Lato', 'Lato Fallback'",fontStyle:"normal"},className:"__className_8fb32a",variable:"__variable_8fb32a"}},5851:e=>{e.exports={style:{fontFamily:"'Playfair Display', 'Playfair Display Fallback'",fontStyle:"normal"},className:"__className_0a80b4",variable:"__variable_0a80b4"}},9406:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,3104,23)),Promise.resolve().then(t.t.bind(t,5851,23)),Promise.resolve().then(t.t.bind(t,1743,23)),Promise.resolve().then(t.bind(t,2985))}},e=>{e.O(0,[3470,3334,5946,8441,8928,7358],()=>e(e.s=9406)),_N_E=e.O()}]);