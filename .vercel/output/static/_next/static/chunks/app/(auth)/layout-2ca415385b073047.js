(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9097],{2985:(e,r,t)=>{"use strict";t.d(r,{A:()=>o,AuthProvider:()=>l});var s=t(5155),n=t(2115),a=t(3318),u=t(3321);let i=(0,n.createContext)(void 0);function l({children:e}){let[r,t]=(0,n.useState)(null),[l,o]=(0,n.useState)(null),[c,d]=(0,n.useState)(null),[h,f]=(0,n.useState)(!0),[g,w]=(0,n.useState)(null),[y]=(0,n.useState)(()=>(0,a.createBrowserClient)("https://lbjymlodxprzqgtyqtcq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImxianltbG9keHByenFndHlxdGNxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjMzNDk1MzEsImV4cCI6MjA3ODkyNTUzMX0.m9k-Id03Kt1scFWvIuK354EHjiO0Y-d8mbO53QqSMRU")),m=(0,u.useRouter)();(0,n.useEffect)(()=>{(async()=>{try{let{data:e}=await y.auth.getSession();o(e.session),t(e.session?.user??null),e.session?.user&&await p(e.session.user.id)}catch(e){}finally{f(!1)}})();let{data:e}=y.auth.onAuthStateChange(async(e,r)=>{o(r),t(r?.user??null),r?.user?await p(r.user.id):d(null),"SIGNED_OUT"===e&&m.push("/login")});return()=>{e?.subscription.unsubscribe()}},[y,m]);let p=async e=>{try{let{data:r,error:t}=await y.from("user_settings").select().eq("user_id",e).single();t&&t.code,d(r||null)}catch(e){}},E=async(e,r,t)=>{try{w(null);let{data:s,error:n}=await y.auth.signUp({email:e,password:r,options:{emailRedirectTo:`${window.location.origin}/auth/callback`,data:t}});if(n)return w(n.message),{user:null,error:n};return{user:s.user,error:null}}catch(r){let e=r instanceof Error?r:Error("Sign up failed");return w(e.message),{user:null,error:e}}},I=async(e,r)=>{try{w(null);let{data:t,error:s}=await y.auth.signInWithPassword({email:e,password:r});if(s)return w(s.message),{user:null,error:s};return{user:t.user,error:null}}catch(r){let e=r instanceof Error?r:Error("Sign in failed");return w(e.message),{user:null,error:e}}},b=async()=>{try{w(null);let{error:e}=await y.auth.signInWithOAuth({provider:"google",options:{redirectTo:`${window.location.origin}/auth/callback`,queryParams:{access_type:"offline",prompt:"consent"}}});if(e)return w(e.message),{error:e};return{error:null}}catch(r){let e=r instanceof Error?r:Error("Google sign in failed");return w(e.message),{error:e}}},S=async e=>{try{w(null);let{error:r}=await y.auth.resetPasswordForEmail(e,{redirectTo:`${window.location.origin}/auth/callback?next=/update-password`});if(r)return w(r.message),{error:r};return{error:null}}catch(r){let e=r instanceof Error?r:Error("Reset password failed");return w(e.message),{error:e}}},_=async e=>{try{w(null);let{error:r}=await y.auth.updateUser({password:e});if(r)return w(r.message),{error:r};return{error:null}}catch(r){let e=r instanceof Error?r:Error("Update password failed");return w(e.message),{error:e}}},k=async()=>{try{w(null),await y.auth.signOut(),t(null),o(null),d(null)}catch(r){let e=r instanceof Error?r:Error("Sign out failed");throw w(e.message),e}},O=async e=>{try{if(!r)throw Error("User not authenticated");w(null);let{data:t,error:s}=await y.from("user_settings").upsert({user_id:r.id,...e,updated_at:new Date().toISOString()},{onConflict:"user_id"}).select().single();if(s)throw s;d(t)}catch(r){let e=r instanceof Error?r:Error("Update failed");throw w(e.message),e}},C=async()=>{try{if(!r)return;await p(r.id)}catch(e){console.error("Refresh user error:",e)}};return(0,s.jsx)(i.Provider,{value:{user:r,session:l,userSettings:c,loading:h,error:g,signUp:E,signIn:I,signInWithGoogle:b,resetPassword:S,updatePassword:_,signOut:k,updateUserSettings:O,refreshUser:C},children:e})}function o(){let e=(0,n.useContext)(i);if(!e)throw Error("useAuth must be used within AuthProvider");return e}},3573:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>i});var s=t(5155),n=t(2115),a=t(3321),u=t(2985);function i({children:e}){let r=(0,a.useRouter)(),{user:t,loading:i}=(0,u.A)();return(0,n.useEffect)(()=>{!i&&t&&r.push("/dashboard")},[t,i,r]),(0,s.jsx)(s.Fragment,{children:e})}},4338:(e,r,t)=>{Promise.resolve().then(t.bind(t,3573))}},e=>{e.O(0,[5946,8441,8928,7358],()=>e(e.s=4338)),_N_E=e.O()}]);